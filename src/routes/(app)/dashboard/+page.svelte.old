<!-- <script lang="ts">
	import type { PageData } from './$types';

	export let data: PageData;
	$: ({ testTable, user } = data);
</script>

<div class="block">
	<p>Protected content for {user.email}</p>
	<p>server-side fetched data with RLS:</p>
	<pre>{JSON.stringify(testTable, null, 2)}</pre>
</div>
<div class="block">
	<p>user:</p>
	<pre>{JSON.stringify(user, null, 2)}</pre>
</div>

// +page.ts
import type { PageLoad } from './$types';
import { redirect } from '@sveltejs/kit';
import { getSupabase } from '@supabase/auth-helpers-sveltekit';

export const load: PageLoad = async (event) => {
	const { session, supabaseClient } = await getSupabase(event);
	if (!session) {
		throw redirect(303, '/');
	}

  TODO: Get relevant data from Supabase
	const { data: testTable } = await supabaseClient.from('test').select('*');
	return {
		testTable,
		user: session.user
	};
}; -->
